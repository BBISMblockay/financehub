<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AP Hub Console</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
/* ===== Global ===== */
body{
  margin:0;background:#121212;color:#e6e6e6;
  font-family:'Inter',sans-serif;display:flex;height:100vh;overflow:hidden;
}

/* ===== Sidebar ===== */
#sidebar{
  width:260px;background:#181818;border-right:1px solid #222;
  display:flex;flex-direction:column;padding:20px 0;
}
#logo{font-size:22px;font-weight:700;text-align:center;margin-bottom:25px;}
.nav-item{
  padding:14px 25px;margin:5px 12px;border-radius:6px;font-size:15px;
  cursor:pointer;opacity:.8;transition:.2s;
}
.nav-item:hover{background:#262626;opacity:1}
.nav-item.active{background:#4f68ff;color:white;opacity:1}

/* ===== Main View ===== */
#main{
  flex:1;padding:25px;overflow:auto;
}
#iframeWrap{
  width:100%;height:85vh;background:#1b1b1b;border:1px solid #2f2f2f;
  border-radius:10px;overflow:hidden;display:flex;align-items:center;justify-content:center;
}
iframe{
  width:100%;height:100%;border:none;
}
#placeholder{
  opacity:.3;text-align:center;font-size:18px;padding:100px 0;
}

/* ===== Settings Panel ===== */
#settingsPage{display:none;}
input{
  width:100%;padding:9px;margin:6px 0;background:#222;border:1px solid #333;color:white;
  border-radius:6px;font-size:14px;
}
.saveBtn{
  background:#4f68ff;padding:10px;border-radius:6px;text-align:center;margin-top:10px;
  cursor:pointer;font-weight:600;
}
.saveBtn:hover{background:#6d83ff;}

.routeRow{
  display:grid;grid-template-columns:120px 1fr;margin:10px 0;gap:10px;
}
hr{border:0;border-top:1px solid #333;margin:15px 0;}
</style>
</head>
<body>

<!-- Sidebar Navigation -->
<div id="sidebar">
  <div id="logo">üìÅ AP Hub</div>

  <div id="nav"></div> <!-- Route buttons dynamically inserted -->

  <div class="nav-item" onclick="openSettings()">‚öô Settings</div>
</div>


<!-- Main Window -->
<div id="main">

  <div id="iframeWrap">
      <div id="placeholder">‚Üê Select a client to load their grid</div>
  </div>

  <!-- SETTINGS PAGE -->
  <div id="settingsPage">
    <h2 style="margin-top:0;">Settings ‚Äî Client Routes</h2>
    <p>Define up to <b>10 Client Portals</b>. Click Save when finished.</p>

    <div id="settingsForm"></div>
    <div class="saveBtn" onclick="saveRoutes()">üíæ Save Routes</div>
  </div>

</div>


<script>
/* ========= STORAGE ========= */

let routes = JSON.parse(localStorage.getItem("apRoutes")) || [
  {name:"",url:""},
  {name:"",url:""},
  {name:"",url:""},
  {name:"",url:""},
  {name:"",url:""},
  {name:"",url:""},
  {name:"",url:""},
  {name:"",url:""},
  {name:"",url:""},
  {name:"",url:""},
]; // 10 Blank Slots

function renderSidebar(){
  let nav=document.getElementById("nav");
  nav.innerHTML="";

  routes.forEach((r,i)=>{
    if(r.name.trim().length){
      let el=document.createElement("div");
      el.className="nav-item";
      el.innerHTML=r.name;
      el.onclick=()=>loadRoute(i,el);
      nav.appendChild(el);
    }
  });
}

function renderSettings(){
  let wrap=document.getElementById("settingsForm");
  wrap.innerHTML="";

  routes.forEach((r,i)=>{
    wrap.innerHTML+=`
      <div class="routeRow">
        <input placeholder="Client Name" id="name${i}" value="${r.name}">
        <input placeholder="Jotform or Grid URL (iframe src)" id="url${i}" value="${r.url}">
      </div>`;
  });
}

function saveRoutes(){
  routes = routes.map((_,i)=>({
    name:document.getElementById("name"+i).value,
    url:document.getElementById("url"+i).value
  }));
  localStorage.setItem("apRoutes",JSON.stringify(routes));
  alert("Saved ‚úì ‚Äî refresh sidebar updated");
  renderSidebar();
}


/* ========= ROUTE LOADING ========= */

function loadRoute(index,el){
  document.querySelectorAll(".nav-item").forEach(n=>n.classList.remove("active"));
  el.classList.add("active");

  document.getElementById("settingsPage").style.display="none";
  document.getElementById("iframeWrap").style.display="flex";
  document.getElementById("placeholder").style.display="none";

  const url=routes[index].url;
  document.getElementById("iframeWrap").innerHTML=`<iframe src="${url}"></iframe>`;
}

function openSettings(){
  document.querySelectorAll(".nav-item").forEach(n=>n.classList.remove("active"));
  document.getElementById("iframeWrap").style.display="none";
  document.getElementById("settingsPage").style.display="block";
  renderSettings();
}


/* INIT */
renderSidebar();
</script>
</body>
</html>
